<?xml version="1.0" encoding="utf-8"?>
<robot name="view_robot_pkg">

  <!-- ===== BASE ===== -->
  <link name="base_link">
    <inertial>
      <origin xyz="0.039595 -0.00037937 -0.012421" rpy="0 0 0" />
      <mass value="10.432" />
      <inertia
        ixx="0.0724"
        ixy="-4.7752E-07"
        ixz="-2.8755E-06"
        iyy="0.13488"
        iyz="3.5422E-07"
        izz="0.185" />
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/base_link.STL" />
      </geometry>
      <material name="">
        <color rgba="1 1 1 1" />
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/base_link.STL" />
      </geometry>
    </collision>
  </link>

  <!-- ===== LEFT WHEEL ===== -->
  <link name="leftwheel_Link">
    <inertial>
      <origin xyz="1.0901E-05 2.7033E-06 0.0016223" rpy="0 0 0" />
      <mass value="0.19451" />
      <inertia
        ixx="0.00019233"
        ixy="-4.1541E-09"
        ixz="1.7928E-08"
        iyy="0.00019235"
        iyz="4.3103E-09"
        izz="0.00036212" />
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/leftwheel_Link.STL" />
      </geometry>
      <material name="">
        <color rgba="0.89804 0.91765 0.92941 1" />
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/leftwheel_Link.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="leftwheel_joint" type="continuous">
    <origin xyz="0.03658 -0.14538 0.06286" rpy="1.5708 0 0" />
    <parent link="base_link" />
    <child link="leftwheel_Link" />
    <axis xyz="0 0 1" />
    <dynamics damping="0.1" friction="0.1" />
  </joint>

  <!-- ===== RIGHT WHEEL ===== -->
  <link name="rightwheel_Link">
    <inertial>
      <origin xyz="9.73918656300976E-06 -5.59293584567223E-06 -0.00162234371795797" rpy="0 0 0" />
      <mass value="0.194507281551966" />
      <inertia
        ixx="0.000192334835886035"
        ixy="7.63388976536888E-09"
        ixz="-1.60553387756337E-08"
        iyy="0.000192343653223033"
        iyz="9.06814415856364E-09"
        izz="0.000362123785735419" />
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/rightwheel_Link.STL" />
      </geometry>
      <material name="">
        <color rgba="0.898039215686275 0.917647058823529 0.929411764705882 1" />
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/rightwheel_Link.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="rightwheel_joint" type="continuous">
    <origin xyz="0.03658 0.14462 0.06286" rpy="1.5708 0 0" />
    <parent link="base_link" />
    <child link="rightwheel_Link" />
    <axis xyz="0 0 1" />
    <dynamics damping="0.1" friction="0.1" />
  </joint>

  <!-- ===== CASTERS ===== -->
  <link name="left_casterwheel_before_Link">
    <inertial>
      <origin xyz="-0.0097055 0.023158 -6.0239E-05" rpy="0 0 0" />
      <mass value="0.050885" />
      <inertia
        ixx="1.8387E-05"
        ixy="3.9261E-06"
        ixz="-2.7421E-09"
        iyy="1.0911E-05"
        iyz="1.3404E-08"
        izz="2.0189E-05" />
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/left_casterwheel_before_Link.STL" />
      </geometry>
      <material name="">
        <color rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/left_casterwheel_before_Link.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="left_casterwheel_before_joint" type="fixed">
    <origin xyz="0.25358 -0.15543 0.062462" rpy="1.5708 0 0" />
    <parent link="base_link" />
    <child link="left_casterwheel_before_Link" />
    <axis xyz="0 0 0" />
    <dynamics damping="0.1" friction="0.1" />
  </joint>

  <link name="left_casterwheel_after_Link">
    <inertial>
      <origin xyz="-0.0097008 0.023158 0.00030738" rpy="0 0 0" />
      <mass value="0.050885" />
      <inertia
        ixx="1.8389E-05"
        ixy="3.9238E-06"
        ixz="6.5486E-08"
        iyy="1.0911E-05"
        iyz="-1.353E-07"
        izz="2.0187E-05" />
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/left_casterwheel_after_Link.STL" />
      </geometry>
      <material name="">
        <color rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/left_casterwheel_after_Link.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="left_casterwheel_after_joint" type="fixed">
    <origin xyz="-0.18642 -0.15554 0.062462" rpy="1.5708 0 0" />
    <parent link="base_link" />
    <child link="left_casterwheel_after_Link" />
    <axis xyz="0 0 0" />
    <dynamics damping="0.1" friction="0.1" />
  </joint>

  <link name="right_casterwheel_before_Link">
    <inertial>
      <origin xyz="-0.0096776 0.023158 0.00073801" rpy="0 0 0" />
      <mass value="0.050885" />
      <inertia
        ixx="1.8398E-05"
        ixy="3.9139E-06"
        ixz="1.4501E-07"
        iyy="1.0911E-05"
        iyz="-3.0947E-07"
        izz="2.0177E-05" />
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/right_casterwheel_before_Link.STL" />
      </geometry>
      <material name="">
        <color rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/right_casterwheel_before_Link.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="right_casterwheel_before_joint" type="fixed">
    <origin xyz="0.25359 0.15433 0.062462" rpy="1.5708 0 0" />
    <parent link="base_link" />
    <child link="right_casterwheel_before_Link" />
    <axis xyz="0 0 0" />
    <dynamics damping="0.1" friction="0.1" />
  </joint>

  <link name="right_casterwheel_after_Link">
    <inertial>
      <origin xyz="-0.0097021 0.023158 0.00026428" rpy="0 0 0" />
      <mass value="0.050885" />
      <inertia
        ixx="1.8388E-05"
        ixy="3.9243E-06"
        ixz="5.7495E-08"
        iyy="1.0911E-05"
        iyz="-1.1786E-07"
        izz="2.0187E-05" />
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/right_casterwheel_after_Link.STL" />
      </geometry>
      <material name="">
        <color rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/right_casterwheel_after_Link.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="right_casterwheel_after_joint" type="fixed">
    <origin xyz="-0.18642 0.15447 0.062462" rpy="1.5708 0 0" />
    <parent link="base_link" />
    <child link="right_casterwheel_after_Link" />
    <axis xyz="0 0 0" />
    <dynamics damping="0.1" friction="0.1" />
  </joint>

  <!-- ===== LIDAR ===== -->
  <link name="lidar_link">
    <!-- Mình giữ inertial cũ (có mass) để Gazebo không lỗi mass=0 -->
    <inertial>
      <origin xyz="0.00303996073383583 9.65820217607716E-07 0.0128055204576732" rpy="0 0 0" />
      <mass value="0.0350818392563211" />
      <inertia
        ixx="1.94316858914545E-05"
        ixy="9.09209227752789E-10"
        ixz="-4.07022921376659E-08"
        iyy="1.93203924159225E-05"
        iyz="8.87508504986298E-10"
        izz="3.70184546846267E-05" />
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/lidar_Link.STL" />
      </geometry>
      <material name="">
        <color rgba="0 0 0 1" />
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://view_robot_pkg/meshes/lidar_Link.STL" />
      </geometry>
    </collision>
  </link>

  <!-- dùng joint theo export mới -->
  <joint name="lidar_joint" type="fixed">
    <origin xyz="0.35047 -0.00042694 0.047292" rpy="0 0 3.1416" />
    <parent link="base_link" />
    <child link="lidar_link" />
    <axis xyz="0 0 0" />
    <dynamics damping="0.1" friction="0.1" />
  </joint>
  

</robot>

<!-- 
  ===== Giữ nguyên Gazebo block của bạn, chỉ sửa child_frame_id base_footprint -> base_link =====
  (các phần khác giữ y chang)
-->

<!-- 
  <gazebo>
    <plugin filename="gz-sim-diff-drive-system" name="gz::sim::systems::DiffDrive">
      <left_joint>leftwheel_joint</left_joint>
      <right_joint>rightwheel_joint</right_joint>
      <wheel_separation>0.328</wheel_separation>
      <wheel_radius>0.05</wheel_radius>

      <max_linear_acceleration>1</max_linear_acceleration>
      <min_linear_acceleration>-1</min_linear_acceleration>
      <max_angular_acceleration>2</max_angular_acceleration>
      <min_angular_acceleration>-2</min_angular_acceleration>
      <max_linear_velocity>0.5</max_linear_velocity>
      <min_linear_velocity>-0.5</min_linear_velocity>
      <max_angular_velocity>1</max_angular_velocity>
      <min_angular_velocity>-1</min_angular_velocity>

      <topic>cmd_vel</topic>
      <odom_topic>odom</odom_topic>
      <tf_topic>tf</tf_topic>
      <frame_id>odom</frame_id>
      <child_frame_id>base_link</child_frame_id>
      <odom_publish_frequency>30</odom_publish_frequency>
    </plugin>

    <plugin filename="gz-sim-joint-state-publisher-system" name="gz::sim::systems::JointStatePublisher">
      <topic>joint_states</topic>
      <joint_name>leftwheel_joint</joint_name>
      <joint_name>rightwheel_joint</joint_name>
    </plugin>
  </gazebo>
-->
